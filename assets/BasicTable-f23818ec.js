var Tt=Object.defineProperty,vt=Object.defineProperties;var $t=Object.getOwnPropertyDescriptors;var Ge=Object.getOwnPropertySymbols;var Rt=Object.prototype.hasOwnProperty,kt=Object.prototype.propertyIsEnumerable;var Xe=(e,o,t)=>o in e?Tt(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,I=(e,o)=>{for(var t in o||(o={}))Rt.call(o,t)&&Xe(e,t,o[t]);if(Ge)for(var t of Ge(o))kt.call(o,t)&&Xe(e,t,o[t]);return e},de=(e,o)=>vt(e,$t(o));var le=(e,o,t)=>new Promise((s,l)=>{var c=i=>{try{u(t.next(i))}catch(a){l(a)}},f=i=>{try{u(t.throw(i))}catch(a){l(a)}},u=i=>i.done?s(i.value):Promise.resolve(i.value).then(c,f);u((t=t.apply(e,o)).next())});import{B as _t}from"./BasicForm-106157f5.js";import{P as Pe,a as Ft,D as It,I as De,b as Oe,R as te,F as Ht,u as Ve,d as Pt}from"./componentMap-3c747af9.js";import{u as Dt}from"./useForm-15663f97.js";import"./RadioButtonGroup-ae13c610.js";import{aa as Ot,ab as At,_ as x,ac as Kt,f as Ae,k as Te,Q as X,L as Ie,Y as Bt,m as q,n as Ke,ad as Lt,ae as Et,G as Mt,K as Nt,af as zt,u as Vt,r as Wt,ag as jt,a8 as qt,x as Le,H as Ut,P as Gt,Z as Xt}from"./index.js";import{aX as Yt,aY as Zt,aZ as Jt,M as He,G as Qt,az as Ye,K as et,a_ as xt,W as tt,aT as en,aU as tn,ar as nn,a$ as on}from"./antd-f3f9d490.js";import{d as pe,a8 as T,_ as P,$ as ae,R as me,E as ne,a1 as N,f as D,e as _,a9 as z,aa as v,a2 as ge,ac as U,F as Ne,k as W,w as Ce,u as n,J as he,n as We,r as nt,s as je,o as an,q as ye,a0 as oe,ab as ze,c as ln,ae as Ze,ad as Je,t as sn,A as rn,aj as Ee,ak as Me}from"./vue-7ba4ee8d.js";import{a as cn,b as un,c as fn,d as dn,e as gn}from"./TableImg.vue_vue_type_style_index_0_lang-96d501e6.js";import{b as Qe}from"./uuid-31b8b5a4.js";import{u as hn}from"./index-20acfc43.js";import{u as pn}from"./useWindowSizeFn-997fa1d0.js";import{o as mn}from"./onMountedOrActivated-65eb8689.js";var Cn=Ot(function(e,o,t){At(e,o,t)});const bn=Cn,Sn=pe({name:"EditTableHeaderIcon",components:{FormOutlined:Yt},props:{title:{type:String,default:""}}});function yn(e,o,t,s,l,c){const f=T("FormOutlined");return P(),ae("span",null,[me(e.$slots,"default"),ne(" "+N(e.title)+" ",1),D(f)])}const wn=x(Sn,[["render",yn]]),Tn=pe({name:"TableHeaderCell",components:{EditTableHeaderCell:wn,BasicHelp:Kt},props:{column:{type:Object,default:()=>({})}},setup(e){const{prefixCls:o}=Ae("basic-table-header-cell"),t=_(()=>{var c;return!!((c=e.column)!=null&&c.edit)}),s=_(()=>{var c,f;return((c=e.column)==null?void 0:c.customTitle)||((f=e.column)==null?void 0:f.title)}),l=_(()=>{var c;return(c=e.column)==null?void 0:c.helpMessage});return{prefixCls:o,getIsEdit:t,getTitle:s,getHelpMessage:l}}}),vn={key:1};function $n(e,o,t,s,l,c){const f=T("EditTableHeaderCell"),u=T("BasicHelp");return P(),ae(Ne,null,[e.getIsEdit?(P(),z(f,{key:0},{default:v(()=>[ne(N(e.getTitle),1)]),_:1})):(P(),ae("span",vn,N(e.getTitle),1)),e.getHelpMessage?(P(),z(u,{key:2,text:e.getHelpMessage,class:ge(`${e.prefixCls}__help`)},null,8,["text","class"])):U("",!0)],64)}const Rn=x(Tn,[["render",$n]]);function kn({page:e,type:o,originalElement:t}){return o==="prev"?e===0?null:D(Zt,null,null):o==="next"?e===1?null:D(Jt,null,null):t}function _n(e){const{t:o}=Te(),t=W({}),s=W(!0);Ce(()=>n(e).pagination,a=>{!X(a)&&a&&(t.value=I(I({},n(t)),a!=null?a:{}))});const l=_(()=>{const{pagination:a}=n(e);return!n(s)||X(a)&&!a?!1:I(I({current:1,pageSize:Pe,size:"small",defaultPageSize:Pe,showTotal:C=>o("component.table.total",{total:C}),showSizeChanger:!0,pageSizeOptions:Ft,itemRender:kn,showQuickJumper:!0},X(a)?{}:a),n(t))});function c(a){const C=n(l);t.value=I(I({},X(C)?{}:C),a)}function f(){return n(l)}function u(){return n(s)}function i(a){return le(this,null,function*(){s.value=a})}return{getPagination:f,getPaginationInfo:l,setShowPagination:i,getShowPagination:u,setPagination:c}}function Fn(e){return({text:o,record:t,index:s})=>(he(t).onValid=()=>le(this,null,function*(){if(Ie(t==null?void 0:t.validCbs)){const l=((t==null?void 0:t.validCbs)||[]).map(f=>f());return(yield Promise.all(l)).every(f=>!!f)}else return!1}),he(t).onEdit=(l,c=!1)=>le(this,null,function*(){var f,u;return c||(t.editable=l),!l&&c?(yield t.onValid())&&(yield(f=t.onSubmitEdit)==null?void 0:f.call(t))?(t.editable=!1,!0):!1:(!l&&!c&&((u=t.onCancelEdit)==null||u.call(t)),!0)}),We(cn,{value:o,record:t,column:e,index:s}))}function ot(e,o){const{key:t,dataIndex:s,children:l}=e;e.align=e.align||It,o&&(t||(e.key=s),X(e.ellipsis)||Object.assign(e,{ellipsis:o})),l&&l.length&&at(l,!!o)}function at(e,o){e&&e.forEach(t=>{const{children:s}=t;ot(t,o),at(s,o)})}function In(e,o,t){const{t:s}=Te(),{showIndexColumn:l,indexColumnProps:c,isTreeTable:f}=n(e);let u=!1;if(n(f)||(t.forEach(()=>{const a=t.findIndex(C=>C.flag===De);l?u=a===-1:!l&&a!==-1&&t.splice(a,1)}),!u))return;const i=t.some(a=>a.fixed==="left");t.unshift(I(I({flag:De,width:50,title:s("component.table.index"),align:"center",customRender:({index:a})=>{const C=n(o);if(X(C))return`${a+1}`;const{current:k=1,pageSize:H=Pe}=C;return((k<1?1:k)-1)*H+a+1}},i?{fixed:"left"}:{}),c))}function Hn(e,o){const{actionColumn:t}=n(e);if(!t)return;const s=o.findIndex(l=>l.flag===Oe);s===-1&&o.push(de(I(de(I({},o[s]),{fixed:"right"}),t),{flag:Oe}))}function Pn(e,o){const t=W(n(e).columns);let s=n(e).columns;const l=_(()=>{const g=He(n(t));if(In(e,o,g),Hn(e,g),!g)return[];const{ellipsis:m}=n(e);return g.forEach(d=>{const{customRender:h,slots:b}=d;ot(d,Reflect.has(d,"ellipsis")?!!d.ellipsis:!!m&&!h&&!b)}),g});function c(g){const m=g.ifShow;let d=!0;return X(m)&&(d=m),q(m)&&(d=m(g)),d}const{hasPermission:f}=Bt(),u=_(()=>{const g=xe(n(l)),m=h=>{const{slots:b,customRender:K,format:O,edit:L,editRow:E,flag:j}=h;(!b||!(b!=null&&b.title))&&(h.customTitle=h.title,Reflect.deleteProperty(h,"title"));const se=[De,Oe].includes(j);return!K&&O&&!L&&!se&&(h.customRender=({text:y,record:w,index:r})=>Dn(y,O,w,r)),(L||E)&&!se&&(h.customRender=Fn(h)),nt(h)};return He(g).filter(h=>f(h.auth)&&c(h)).map(h=>{var b;return(b=h.children)!=null&&b.length&&(h.children=h.children.map(m)),m(h)})});Ce(()=>n(e).columns,g=>{var m;t.value=g,s=(m=g==null?void 0:g.filter(d=>!d.flag))!=null?m:[]});function i(g,m){!g||!m||s.forEach(d=>{if(d.dataIndex===g){Object.assign(d,m);return}})}function a(g){const m=He(g);if(!Ie(m))return;if(m.length<=0){t.value=[];return}const d=m[0],h=s.map(b=>b.dataIndex);if(!Ke(d)&&!Ie(d))t.value=m;else{const b=m.map(O=>O.toString()),K=[];s.forEach(O=>{var L;K.push(de(I({},O),{defaultHidden:!b.includes(((L=O.dataIndex)==null?void 0:L.toString())||O.key)}))}),Qt(h,m)||K.sort((O,L)=>{var E,j;return b.indexOf((E=O.dataIndex)==null?void 0:E.toString())-b.indexOf((j=L.dataIndex)==null?void 0:j.toString())}),t.value=K}}function C(g){const{ignoreIndex:m,ignoreAction:d,sort:h}=g||{};let b=he(n(l));return m&&(b=b.filter(K=>K.flag!==De)),d&&(b=b.filter(K=>K.flag!==Oe)),h&&(b=xe(b)),b}function k(){return s}function H(g){Ie(g)&&(s=g.filter(m=>!m.flag))}return{getColumnsRef:l,getCacheColumns:k,getColumns:C,setColumns:a,getViewColumns:u,setCacheColumnsByField:i,setCacheColumns:H}}function xe(e){const o=[],t=[],s=[];for(const l of e){if(l.fixed==="left"){o.push(l);continue}if(l.fixed==="right"){t.push(l);continue}s.push(l)}return[...o,...s,...t].filter(l=>!l.defaultHidden)}function Dn(e,o,t,s){if(!o)return e;if(q(o))return o(e,t,s);try{const l="date|";if(Ke(o)&&o.startsWith(l)&&e){const c=o.replace(l,"");return c?Lt(e,c):e}if(Et(o))return o.get(e)}catch(l){return e}}function On(e,{getPaginationInfo:o,setPagination:t,setLoading:s,getFieldsValue:l,clearSelectedRowKeys:c,tableData:f},u){const i=nt({sortInfo:{},filterInfo:{}}),a=W([]),C=W({});je(()=>{f.value=n(a)}),Ce(()=>n(e).dataSource,()=>{const{dataSource:r,api:p}=n(e);!p&&r&&(a.value=r)},{immediate:!0});function k(r,p,S){const{clearSelectOnPageChange:R,sortFn:A,filterFn:F}=n(e);R&&c(),t(r);const B={};if(S&&q(A)){const $=A(S);i.sortInfo=$,B.sortInfo=$}if(p&&q(F)){const $=F(p);i.filterInfo=$,B.filterInfo=$}E(B)}function H(r){!r||!Array.isArray(r)||r.forEach(p=>{p[te]||(p[te]=Qe()),p.children&&p.children.length&&H(p.children)})}const g=_(()=>n(e).autoCreateKey&&!n(e).rowKey),m=_(()=>{const{rowKey:r}=n(e);return n(g)?te:r}),d=_(()=>{const r=n(a);if(!r||r.length===0)return n(a);if(n(g)){const p=r[0],S=r[r.length-1];if(p&&S&&(!p[te]||!S[te])){const R=He(n(a));R.forEach(A=>{A[te]||(A[te]=Qe()),A.children&&A.children.length&&H(A.children)}),a.value=R}}return n(a)});function h(r,p,S){return le(this,null,function*(){return a.value[r]&&(a.value[r][p]=S),a.value[r]})}function b(r,p){const S=L(r);if(S){for(const R in S)Reflect.has(p,R)&&(S[R]=p[R]);return S}}function K(r){var A;if(!a.value||a.value.length==0)return;const p=n(m);if(!p)return;const S=Array.isArray(r)?r:[r];function R(F,B){const $=Y(F,B);if($===null||$.index===-1)return;$.data.splice($.index,1);function Y(M,G){var ie;if(M==null)return null;for(let J=0;J<M.length;J++){const Q=M[J];let re=p;if(q(p)&&(re=p(Q)),Q[re]===G)return{index:J,data:M};if(((ie=Q.children)==null?void 0:ie.length)>0){const ee=Y(Q.children,G);if(ee!=null)return ee}}return null}}for(const F of S)R(a.value,F),R(n(e).dataSource,F);t({total:(A=n(e).dataSource)==null?void 0:A.length})}function O(r,p){var R;p=p!=null?p:(R=a.value)==null?void 0:R.length;const S=Nt(r)?[r]:r;return n(a).splice(p,0,...S),n(a)}function L(r){if(!a.value||a.value.length==0)return;const p=n(m);if(!p)return;const{childrenColumnName:S="children"}=n(e);return(A=>{let F;return A.some(function B($){if(typeof p=="function"){if(p($)===r)return F=$,!0}else if(Reflect.has($,p)&&$[p]===r)return F=$,!0;return $[S]&&$[S].some(B)}),F})(a.value)}function E(r){return le(this,null,function*(){var M,G,ie;const{api:p,searchInfo:S,defSort:R,fetchSetting:A,beforeFetch:F,afterFetch:B,useSearchForm:$,pagination:Y}=n(e);if(!(!p||!q(p)))try{s(!0);const{pageField:J,sizeField:Q,listField:re,totalField:ee}=Object.assign({},Ht,A);let ce={};const{current:ve=1,pageSize:$e=Pe}=n(o);X(Y)&&!Y||X(o)?ce={}:(ce[J]=r&&r.page||ve,ce[Q]=$e);const{sortInfo:Re={},filterInfo:Be}=i;let be=bn(ce,$?l():{},S,(M=r==null?void 0:r.searchInfo)!=null?M:{},R,Re,Be,(G=r==null?void 0:r.sortInfo)!=null?G:{},(ie=r==null?void 0:r.filterInfo)!=null?ie:{});F&&q(F)&&(be=(yield F(be))||be);const ue=yield p(be);C.value=ue;const ke=Array.isArray(ue);let fe=ke?ue:Ye(ue,re);const Se=ke?ue.length:Ye(ue,ee);if(Number(Se)){const we=Math.ceil(Se/$e);if(ve>we)return t({current:we}),yield E(r)}return B&&q(B)&&(fe=(yield B(fe))||fe),a.value=fe,t({total:Se||0}),r&&r.page&&t({current:r.page||1}),u("fetch-success",{items:n(fe),total:Se}),fe}catch(J){u("fetch-error",J),a.value=[],t({total:0})}finally{s(!1)}})}function j(r){a.value=r}function se(){return d.value}function y(){return C.value}function w(r){return le(this,null,function*(){return yield E(r)})}return an(()=>{Mt(()=>{n(e).immediate&&E()},16)}),{getDataSourceRef:d,getDataSource:se,getRawDataSource:y,getRowKey:m,setTableData:j,getAutoCreateKey:g,fetch:E,reload:w,updateTableData:h,updateTableDataRecord:b,deleteTableDataRecord:K,insertTableDataRecord:O,findTableDataRecord:L,handleTableChange:k}}function An(e){const o=W(n(e).loading);Ce(()=>n(e).loading,l=>{o.value=l});const t=_(()=>n(o));function s(l){o.value=l}return{getLoading:t,setLoading:s}}function Kn(e,o,t){const s=W([]),l=W([]),c=_(()=>{const{rowSelection:d}=n(e);return d?I({selectedRowKeys:n(s),onChange:h=>{i(h)}},et(d,["onChange"])):null});Ce(()=>{var d;return(d=n(e).rowSelection)==null?void 0:d.selectedRowKeys},d=>{i(d)}),Ce(()=>n(s),()=>{ye(()=>{const{rowSelection:d}=n(e);if(d){const{onChange:h}=d;h&&q(h)&&h(H(),g())}t("selection-change",{keys:H(),rows:g()})})},{deep:!0});const f=_(()=>n(e).autoCreateKey&&!n(e).rowKey),u=_(()=>{const{rowKey:d}=n(e);return n(f)?te:d});function i(d){var K;s.value=d;const h=zt(he(n(o)).concat(he(n(l))),O=>d==null?void 0:d.includes(O[n(u)]),{children:(K=e.value.childrenColumnName)!=null?K:"children"}),b=[];d==null||d.forEach(O=>{const L=h.find(E=>E[n(u)]===O);L&&b.push(L)}),l.value=b}function a(d){l.value=d}function C(){l.value=[],s.value=[]}function k(d){const b=n(s).findIndex(K=>K===d);b!==-1&&n(s).splice(b,1)}function H(){return n(s)}function g(){return n(l)}function m(){return n(c)}return{getRowSelection:m,getRowSelectionRef:c,getSelectRows:g,getSelectRowKeys:H,setSelectedRowKeys:i,clearSelectedRowKeys:C,deleteSelectRowByKey:k,setSelectedRows:a}}function Bn(e,o,t,s,l,c,f){const u=W(167),i=hn(),a=Vt(k,100),C=_(()=>{const{canResize:y,scroll:w}=n(e);return y&&!(w||{}).y});Ce(()=>{var y;return[n(C),(y=n(l))==null?void 0:y.length]},()=>{a()},{flush:"post"});function k(){ye(()=>{E()})}function H(y){var w;u.value=y,(w=i==null?void 0:i.redoModalHeight)==null||w.call(i)}let g,m,d;function h(y,w){const r=y.scrollHeight>y.clientHeight,p=y.scrollWidth>y.clientWidth;r?w.classList.contains("hide-scrollbar-y")&&w.classList.remove("hide-scrollbar-y"):!w.classList.contains("hide-scrollbar-y")&&w.classList.add("hide-scrollbar-y"),p?w.classList.contains("hide-scrollbar-x")&&w.classList.remove("hide-scrollbar-x"):!w.classList.contains("hide-scrollbar-x")&&w.classList.add("hide-scrollbar-x")}function b(y){const{pagination:w}=n(e);let r=2;if(X(w))r=-8;else if(g=y.querySelector(".ant-pagination"),g){const p=g.offsetHeight;r+=p||0}else r+=24;return r}function K(y){const{pagination:w}=n(e);let r=0;if(!X(w))if(!m)m=y.querySelector(".ant-table-footer");else{const p=m.offsetHeight;r+=p||0}return r}function O(y){let w=0;return y&&(w=y.offsetHeight),w}function L(y,w){var F,B,$,Y,M,G;const{pagination:r,isCanResizeParent:p,useSearchForm:S}=n(e);let R=30,A=0;if(n(c)&&p){let Q=10;const re=(B=(F=n(c))==null?void 0:F.offsetHeight)!=null?B:0;let ee=(Y=($=n(f))==null?void 0:$.$el.offsetHeight)!=null?Y:0;ee&&(ee+=16),X(r)&&!r&&(Q=0),X(S)&&!S&&(R=0);const ce=(G=(M=y.querySelector(".ant-table-title"))==null?void 0:M.offsetHeight)!=null?G:0;A=re-ee-ce-12-Q}else A=Wt(w).bottomIncludeBody;return{paddingHeight:R,bottomIncludeBody:A}}function E(){return le(this,null,function*(){var G;const{resizeHeightOffset:y,maxHeight:w}=n(e),r=n(l),p=n(o);if(!p)return;const S=p.$el;if(!S||!d&&(d=S.querySelector(".ant-table-body"),!d)||(h(d,S),d.style.height="unset",!n(C)||!n(r)||r.length===0))return;yield ye();const R=S.querySelector(".ant-table-thead ");if(!R)return;const A=b(S),F=K(S),B=O(R),{paddingHeight:$,bottomIncludeBody:Y}=L(S,R);let M=Y-(y||0)-$-A-F-B;M=(G=M>w?w:M)!=null?G:M,H(M),d.style.height=`${M}px`})}pn(E,{wait:280}),mn(()=>{E(),ye(()=>{a()})});const j=_(()=>{var F,B;let y=0;n(s)&&(y+=60);const w=150,r=n(t).filter($=>!$.defaultHidden);r.forEach($=>{y+=Number.parseFloat($.width)||0});const S=r.filter($=>!Reflect.has($,"width")).length;S!==0&&(y+=S*w);const R=n(o);return((B=(F=R==null?void 0:R.$el)==null?void 0:F.offsetWidth)!=null?B:0)>y?"100%":y});return{getScrollRef:_(()=>{const y=n(u),{canResize:w,scroll:r}=n(e);return I({x:n(j),y:w?y:null,scrollToFirstRowOnChange:!1},r)}),redoHeight:k}}function Ln(e,o){let t;function s(c){return le(this,null,function*(){var i;const{id:f}=c,u=t==null?void 0:t.querySelector(`[data-row-key="${f}"]`);yield ye(),t==null||t.scrollTo({top:(i=u==null?void 0:u.offsetTop)!=null?i:0,behavior:"smooth"})})}function l(c){const f=n(e);if(!f)return;const u=f.$el;if(!u||!t&&(t=u.querySelector(".ant-table-body"),!t))return;const i=n(o);if(i)if(c==="top")s(i[0]);else if(c==="bottom")s(i[i.length-1]);else{const a=i.find(C=>C.id===c);a&&s(a)}}return{scrollTo:l}}function En(e,o,t){return!o||t?e[te]:Ke(o)?e[o]:q(o)?e[o(e)]:null}function Mn(e,{setSelectedRowKeys:o,getSelectRowKeys:t,getAutoCreateKey:s,clearSelectedRowKeys:l,emit:c}){return{customRow:(u,i)=>({onClick:a=>{a==null||a.stopPropagation();function C(){var K;const{rowSelection:k,rowKey:H,clickToRowSelect:g}=n(e);if(!k||!g)return;const m=t()||[],d=En(u,H,n(s));if(d===null)return;if(k.type==="checkbox"){const O=(K=a.composedPath)==null?void 0:K.call(a).find(j=>j.tagName==="TR");if(!O)return;const L=O.querySelector("input[type=checkbox]");if(!L||L.hasAttribute("disabled"))return;if(!m.includes(d)){m.push(d),o(m);return}const E=m.findIndex(j=>j===d);m.splice(E,1),o(m);return}if(k.type==="radio"){if(!m.includes(d)){m.length&&l(),o([d]);return}l()}}C(),c("row-click",u,i,a)},onDblclick:a=>{c("row-dbClick",u,i,a)},onContextmenu:a=>{c("row-contextmenu",u,i,a)},onMouseenter:a=>{c("row-mouseenter",u,i,a)},onMouseleave:a=>{c("row-mouseleave",u,i,a)}})}}function Nn(e,o){function t(s,l){const{striped:c,rowClassName:f}=n(e),u=[];return c&&u.push((l||0)%2===1?`${o}-row__striped`:""),f&&q(f)&&u.push(f(s,l)),u.filter(i=>!!i).join(" ")}return{getRowClassName:t}}function zn(e,o,t,s,l,c){const f=T("Checkbox"),u=T("a-button"),i=T("DragOutlined"),a=T("Icon"),C=T("Tooltip"),k=T("Divider"),H=T("CheckboxGroup"),g=T("ScrollContainer"),m=T("SettingOutlined"),d=T("Popover");return P(),z(C,{placement:"top"},{title:v(()=>[oe("span",null,N(e.t("component.table.settingColumn")),1)]),default:v(()=>[D(d,{placement:"bottomLeft",trigger:"click",onVisibleChange:e.handleVisibleChange,overlayClassName:`${e.prefixCls}__cloumn-list`,getPopupContainer:e.getPopupContainer},{title:v(()=>[oe("div",{class:ge(`${e.prefixCls}__popover-title`)},[D(f,{indeterminate:e.indeterminate,checked:e.checkAll,"onUpdate:checked":o[0]||(o[0]=h=>e.checkAll=h),onChange:e.onCheckAllChange},{default:v(()=>[ne(N(e.t("component.table.settingColumnShow")),1)]),_:1},8,["indeterminate","checked","onChange"]),D(f,{checked:e.checkIndex,"onUpdate:checked":o[1]||(o[1]=h=>e.checkIndex=h),onChange:e.handleIndexCheckChange},{default:v(()=>[ne(N(e.t("component.table.settingIndexColumnShow")),1)]),_:1},8,["checked","onChange"]),D(f,{checked:e.checkSelect,"onUpdate:checked":o[2]||(o[2]=h=>e.checkSelect=h),onChange:e.handleSelectCheckChange,disabled:!e.defaultRowSelection},{default:v(()=>[ne(N(e.t("component.table.settingSelectColumnShow")),1)]),_:1},8,["checked","onChange","disabled"]),D(u,{size:"small",type:"link",onClick:e.reset},{default:v(()=>[ne(N(e.t("common.resetText")),1)]),_:1},8,["onClick"])],2)]),content:v(()=>[D(g,null,{default:v(()=>[D(H,{value:e.checkedList,"onUpdate:value":o[3]||(o[3]=h=>e.checkedList=h),onChange:e.onChange,ref:"columnListRef"},{default:v(()=>[(P(!0),ae(Ne,null,ze(e.plainOptions,h=>(P(),ae(Ne,{key:h.value},["ifShow"in h&&!h.ifShow?U("",!0):(P(),ae("div",{key:0,class:ge(`${e.prefixCls}__check-item`)},[D(i,{class:"table-column-drag-icon"}),D(f,{value:h.value},{default:v(()=>[ne(N(h.label),1)]),_:2},1032,["value"]),D(C,{placement:"bottomLeft",mouseLeaveDelay:.4,getPopupContainer:e.getPopupContainer},{title:v(()=>[ne(N(e.t("component.table.settingFixedLeft")),1)]),default:v(()=>[D(a,{icon:"line-md:arrow-align-left",class:ge([`${e.prefixCls}__fixed-left`,{active:h.fixed==="left",disabled:!e.checkedList.includes(h.value)}]),onClick:b=>e.handleColumnFixed(h,"left")},null,8,["class","onClick"])]),_:2},1032,["getPopupContainer"]),D(k,{type:"vertical"}),D(C,{placement:"bottomLeft",mouseLeaveDelay:.4,getPopupContainer:e.getPopupContainer},{title:v(()=>[ne(N(e.t("component.table.settingFixedRight")),1)]),default:v(()=>[D(a,{icon:"line-md:arrow-align-left",class:ge([`${e.prefixCls}__fixed-right`,{active:h.fixed==="right",disabled:!e.checkedList.includes(h.value)}]),onClick:b=>e.handleColumnFixed(h,"right")},null,8,["class","onClick"])]),_:2},1032,["getPopupContainer"])],2))],64))),128))]),_:1},8,["value","onChange"])]),_:1})]),default:v(()=>[D(m)]),_:1},8,["onVisibleChange","overlayClassName","getPopupContainer"])]),_:1})}const Vn=x(un,[["render",zn]]);function Wn(e,o,t,s,l,c){const f=T("ColumnHeightOutlined"),u=T("MenuItem"),i=T("Menu"),a=T("Dropdown"),C=T("Tooltip");return P(),z(C,{placement:"top"},{title:v(()=>[oe("span",null,N(e.t("component.table.settingDens")),1)]),default:v(()=>[D(a,{placement:"bottom",trigger:["click"],getPopupContainer:e.getPopupContainer},{overlay:v(()=>[D(i,{onClick:e.handleTitleClick,selectable:"",selectedKeys:e.selectedKeysRef,"onUpdate:selectedKeys":o[0]||(o[0]=k=>e.selectedKeysRef=k)},{default:v(()=>[D(u,{key:"default"},{default:v(()=>[oe("span",null,N(e.t("component.table.settingDensDefault")),1)]),_:1}),D(u,{key:"middle"},{default:v(()=>[oe("span",null,N(e.t("component.table.settingDensMiddle")),1)]),_:1}),D(u,{key:"small"},{default:v(()=>[oe("span",null,N(e.t("component.table.settingDensSmall")),1)]),_:1})]),_:1},8,["onClick","selectedKeys"])]),default:v(()=>[D(f)]),_:1},8,["getPopupContainer"])]),_:1})}const jn=x(fn,[["render",Wn]]),qn=pe({name:"RedoSetting",components:{RedoOutlined:xt,Tooltip:tt},setup(){const e=Ve(),{t:o}=Te();function t(){e.reload()}return{redo:t,t:o}}});function Un(e,o,t,s,l,c){const f=T("RedoOutlined"),u=T("Tooltip");return P(),z(u,{placement:"top"},{title:v(()=>[oe("span",null,N(e.t("common.redo")),1)]),default:v(()=>[D(f,{onClick:e.redo},null,8,["onClick"])]),_:1})}const Gn=x(qn,[["render",Un]]),Xn=pe({name:"FullScreenSetting",components:{FullscreenExitOutlined:en,FullscreenOutlined:tn,Tooltip:tt},setup(){const e=Ve(),{t:o}=Te(),{toggle:t,isFullscreen:s}=jt(e.wrapRef);return{toggle:t,isFullscreen:s,t:o}}});function Yn(e,o,t,s,l,c){const f=T("FullscreenOutlined"),u=T("FullscreenExitOutlined"),i=T("Tooltip");return P(),z(i,{placement:"top"},{title:v(()=>[oe("span",null,N(e.t("component.table.settingFullScreen")),1)]),default:v(()=>[e.isFullscreen?(P(),z(u,{key:1,onClick:e.toggle},null,8,["onClick"])):(P(),z(f,{key:0,onClick:e.toggle},null,8,["onClick"]))]),_:1})}const Zn=x(Xn,[["render",Yn]]),Jn=pe({name:"TableSetting",components:{ColumnSetting:Vn,SizeSetting:jn,RedoSetting:Gn,FullScreenSetting:Zn},props:{setting:{type:Object,default:()=>({})}},emits:["columns-change"],setup(e,{emit:o}){const{t}=Te(),s=Ve(),l=_(()=>I({redo:!0,size:!0,setting:!0,fullScreen:!1},e.setting));function c(u){o("columns-change",u)}function f(){return s?n(s.wrapRef):document.body}return{getSetting:l,t,handleColumnChange:c,getTableContainer:f}}}),Qn={class:"table-settings"};function xn(e,o,t,s,l,c){const f=T("RedoSetting"),u=T("SizeSetting"),i=T("ColumnSetting"),a=T("FullScreenSetting");return P(),ae("div",Qn,[e.getSetting.redo?(P(),z(f,{key:0,getPopupContainer:e.getTableContainer},null,8,["getPopupContainer"])):U("",!0),e.getSetting.size?(P(),z(u,{key:1,getPopupContainer:e.getTableContainer},null,8,["getPopupContainer"])):U("",!0),e.getSetting.setting?(P(),z(i,{key:2,onColumnsChange:e.handleColumnChange,getPopupContainer:e.getTableContainer},null,8,["onColumnsChange","getPopupContainer"])):U("",!0),e.getSetting.fullScreen?(P(),z(a,{key:3,getPopupContainer:e.getTableContainer},null,8,["getPopupContainer"])):U("",!0)])}const eo=x(Jn,[["render",xn]]),to=pe({name:"BasicTableTitle",components:{BasicTitle:qt},props:{title:{type:[Function,String]},getSelectRows:{type:Function},helpMessage:{type:[String,Array]}},setup(e){const{prefixCls:o}=Ae("basic-table-title");return{getTitle:_(()=>{const{title:s,getSelectRows:l=()=>{}}=e;let c=s;return q(s)&&(c=s({selectRows:l()})),c}),prefixCls:o}}});function no(e,o,t,s,l,c){const f=T("BasicTitle");return e.getTitle?(P(),z(f,{key:0,class:ge(e.prefixCls),helpMessage:e.helpMessage},{default:v(()=>[ne(N(e.getTitle),1)]),_:1},8,["class","helpMessage"])):U("",!0)}const oo=x(to,[["render",no]]),ao=pe({name:"BasicTableHeader",components:{Divider:nn,TableTitle:oo,TableSetting:eo},props:{title:{type:[Function,String]},tableSetting:{type:Object},showTableSetting:{type:Boolean},titleHelpMessage:{type:[String,Array],default:""}},emits:["columns-change"],setup(e,{emit:o}){const{prefixCls:t}=Ae("basic-table-header");function s(l){o("columns-change",l)}return{prefixCls:t,handleColumnChange:s}}}),lo={style:{width:"100%"}},so={key:0,style:{margin:"5px"}},io={class:"flex items-center"};function ro(e,o,t,s,l,c){const f=T("TableTitle"),u=T("Divider"),i=T("TableSetting");return P(),ae("div",lo,[e.$slots.headerTop?(P(),ae("div",so,[me(e.$slots,"headerTop")])):U("",!0),oe("div",io,[e.$slots.tableTitle?me(e.$slots,"tableTitle",{key:0}):U("",!0),!e.$slots.tableTitle&&e.title?(P(),z(f,{key:1,helpMessage:e.titleHelpMessage,title:e.title},null,8,["helpMessage","title"])):U("",!0),oe("div",{class:ge(`${e.prefixCls}__toolbar`)},[me(e.$slots,"toolbar"),e.$slots.toolbar&&e.showTableSetting?(P(),z(u,{key:0,type:"vertical"})):U("",!0),e.showTableSetting?(P(),z(i,{key:1,setting:e.tableSetting,onColumnsChange:e.handleColumnChange},null,8,["setting","onColumnsChange"])):U("",!0)],2)])])}const co=x(ao,[["render",ro]]);function uo(e,o,t){return{getHeaderProps:_(()=>{const{title:l,showTableSetting:c,titleHelpMessage:f,tableSetting:u}=n(e),i=!o.tableTitle&&!l&&!o.toolbar&&!c;return i&&!Ke(l)?{}:{title:i?null:()=>We(co,{title:l,titleHelpMessage:f,showTableSetting:c,tableSetting:u,onColumnsChange:t.onColumnsChange},I(I(I({},o.toolbar?{toolbar:()=>Le(o,"toolbar")}:{}),o.tableTitle?{tableTitle:()=>Le(o,"tableTitle")}:{}),o.headerTop?{headerTop:()=>Le(o,"headerTop")}:{}))}})}}function fo(e,o,t){const s=W([]),l=_(()=>n(e).autoCreateKey&&!n(e).rowKey),c=_(()=>{const{rowKey:k}=n(e);return n(l)?te:k}),f=_(()=>{const{isTreeTable:k}=n(e);return k?{expandedRowKeys:n(s),onExpandedRowsChange:H=>{s.value=H,t("expanded-rows-change",H)}}:{}});function u(){const k=a();s.value=k}function i(k){const{isTreeTable:H}=n(e);H&&(s.value=[...s.value,...k])}function a(k){const H=[],{childrenColumnName:g}=n(e);return he(k||n(o)).forEach(m=>{H.push(m[n(c)]);const d=m[g||"children"];d!=null&&d.length&&H.push(...a(d))}),H}function C(){s.value=[]}return{getExpandOption:f,expandAll:u,expandRows:i,collapseAll:C}}function go(e,o,t,s,l,c){const f=T("Table");return e.summaryFunc||e.summaryData?(P(),z(f,{key:0,showHeader:!1,bordered:!1,pagination:!1,dataSource:e.getDataSource,rowKey:u=>u[e.rowKey],columns:e.getColumns,tableLayout:"fixed",scroll:e.scroll},null,8,["dataSource","rowKey","columns","scroll"])):U("",!0)}const ho=x(dn,[["render",go]]);function po(e,o,t,s){const l=_(()=>(n(s)||[]).length===0),c=_(()=>{const{summaryFunc:u,showSummary:i,summaryData:a}=n(e);return i&&!n(l)?()=>We(ho,{summaryFunc:u,summaryData:a,scroll:n(o)}):void 0});je(()=>{f()});function f(){const{showSummary:u}=n(e);!u||n(l)||ye(()=>{const i=n(t);if(!i)return;const a=i.$el.querySelector(".ant-table-content");Ut({el:a,name:"scroll",listener:()=>{const C=i.$el.querySelector(".ant-table-footer .ant-table-content");!C||!a||(C.scrollLeft=a.scrollLeft)},wait:0,options:!0})})}return{getFooterProps:c}}function mo(e,o,t,s){const l=_(()=>{const{formConfig:i}=n(e),{submitButtonOptions:a}=i||{};return de(I({showAdvancedButton:!0},i),{submitButtonOptions:I({loading:n(s)},a),compact:!0})}),c=_(()=>Object.keys(o).map(a=>a.startsWith("form-")?a:null).filter(a=>!!a));function f(i){var a,C;return i&&(C=(a=i==null?void 0:i.replace)==null?void 0:a.call(i,/form-/,""))!=null?C:""}function u(i){const{handleSearchInfoFn:a}=n(e);a&&q(a)&&(i=a(i)||i),t({searchInfo:i,page:1})}return{getFormProps:l,replaceFormSlotKey:f,getFormSlotKeys:c,handleSearchInfoChange:u}}const Co=pe({name:"BasicTable",components:{Table:on,BasicForm:_t,HeaderCell:Rn},props:gn,emits:["fetch-success","fetch-error","selection-change","register","row-click","row-dbClick","row-contextmenu","row-mouseenter","row-mouseleave","edit-end","edit-cancel","edit-row-end","edit-change","expanded-rows-change","change","columns-change"],setup(e,{attrs:o,emit:t,slots:s,expose:l}){const c=W(null),f=W([]),u=W(null),i=W(null),a=W(),{prefixCls:C}=Ae("basic-table"),[k,H]=Dt(),g=_(()=>I(I({},e),n(a))),m=ln(Gt,!1);je(()=>{n(m)&&e.canResize&&Xt()});const{getLoading:d,setLoading:h}=An(g),{getPaginationInfo:b,getPagination:K,setPagination:O,setShowPagination:L,getShowPagination:E}=_n(g),{getRowSelection:j,getRowSelectionRef:se,getSelectRows:y,setSelectedRows:w,clearSelectedRowKeys:r,getSelectRowKeys:p,deleteSelectRowByKey:S,setSelectedRowKeys:R}=Kn(g,f,t),{handleTableChange:A,getDataSourceRef:F,getDataSource:B,getRawDataSource:$,setTableData:Y,updateTableDataRecord:M,deleteTableDataRecord:G,insertTableDataRecord:ie,findTableDataRecord:J,fetch:Q,getRowKey:re,reload:ee,getAutoCreateKey:ce,updateTableData:ve}=On(g,{tableData:f,getPaginationInfo:b,setLoading:h,setPagination:O,getFieldsValue:H.getFieldsValue,clearSelectedRowKeys:r},t);function $e(...V){A.call(void 0,...V),t("change",...V);const{onChange:Z}=n(g);Z&&q(Z)&&Z.call(void 0,...V)}const{getViewColumns:Re,getColumns:Be,setCacheColumnsByField:be,setCacheColumns:ue,setColumns:ke,getColumnsRef:fe,getCacheColumns:Se}=Pn(g,b),{getScrollRef:we,redoHeight:qe}=Bn(g,c,fe,se,F,u,i),{scrollTo:lt}=Ln(c,F),{customRow:st}=Mn(g,{setSelectedRowKeys:R,getSelectRowKeys:p,clearSelectedRowKeys:r,getAutoCreateKey:ce,emit:t}),{getRowClassName:it}=Nn(g,C),{getExpandOption:rt,expandAll:ct,expandRows:ut,collapseAll:ft}=fo(g,f,t),dt={onColumnsChange:V=>{var Z,Ue;t("columns-change",V),(Ue=(Z=n(g)).onColumnsChange)==null||Ue.call(Z,V)}},{getHeaderProps:gt}=uo(g,s,dt),{getFooterProps:ht}=po(g,we,c,F),{getFormProps:pt,replaceFormSlotKey:mt,getFormSlotKeys:Ct,handleSearchInfoChange:bt}=mo(g,s,Q,d),_e=_(()=>{const V=n(F);let Z=I(de(I(I(de(I({},o),{customRow:st}),n(g)),n(gt)),{scroll:n(we),loading:n(d),tableLayout:"fixed",rowSelection:n(se),rowKey:n(re),columns:he(n(Re)),pagination:he(n(b)),dataSource:V,footer:n(ht)}),n(rt));return Z=et(Z,["class","onChange"]),Z}),St=_(()=>{const V=n(_e);return[C,o.class,{[`${C}-form-container`]:V.useSearchForm,[`${C}--inset`]:V.inset}]}),yt=_(()=>{const{emptyDataIsShowTable:V,useSearchForm:Z}=n(g);return V||!Z?!0:!!n(F).length});function wt(V){a.value=I(I({},n(a)),V)}const Fe={reload:ee,getSelectRows:y,setSelectedRows:w,clearSelectedRowKeys:r,getSelectRowKeys:p,deleteSelectRowByKey:S,setPagination:O,setTableData:Y,updateTableDataRecord:M,deleteTableDataRecord:G,insertTableDataRecord:ie,findTableDataRecord:J,redoHeight:qe,setSelectedRowKeys:R,setColumns:ke,setLoading:h,getDataSource:B,getRawDataSource:$,setProps:wt,getRowSelection:j,getPaginationRef:K,getColumns:Be,getCacheColumns:Se,emit:t,updateTableData:ve,setShowPagination:L,getShowPagination:E,setCacheColumnsByField:be,expandAll:ct,expandRows:ut,collapseAll:ft,scrollTo:lt,getSize:()=>n(_e).size,setCacheColumns:ue};return Pt(de(I({},Fe),{wrapRef:u,getBindValues:_e})),l(Fe),t("register",Fe,H),{formRef:i,tableElRef:c,getBindValues:_e,getLoading:d,registerForm:k,handleSearchInfoChange:bt,getEmptyDataIsShowTable:yt,handleTableChange:$e,getRowClassName:it,wrapRef:u,tableAction:Fe,redoHeight:qe,getFormProps:pt,replaceFormSlotKey:mt,getFormSlotKeys:Ct,getWrapperClass:St,columns:Re}}});function bo(e,o,t,s,l,c){const f=T("BasicForm"),u=T("HeaderCell"),i=T("Table");return P(),ae("div",{ref:"wrapRef",class:ge(e.getWrapperClass)},[e.getBindValues.useSearchForm?(P(),z(f,Je({key:0,ref:"formRef",submitOnReset:""},e.getFormProps,{tableAction:e.tableAction,onRegister:e.registerForm,onSubmit:e.handleSearchInfoChange,onAdvancedChange:e.redoHeight}),Ze({_:2},[ze(e.getFormSlotKeys,a=>({name:e.replaceFormSlotKey(a),fn:v(C=>[me(e.$slots,a,Ee(Me(C||{})))])}))]),1040,["tableAction","onRegister","onSubmit","onAdvancedChange"])):U("",!0),sn(D(i,Je({ref:"tableElRef"},e.getBindValues,{rowClassName:e.getRowClassName,onChange:e.handleTableChange}),Ze({headerCell:v(({column:a})=>[D(u,{column:a},null,8,["column"])]),bodyCell:v(a=>[me(e.$slots,"bodyCell",Ee(Me(a||{})))]),_:2},[ze(Object.keys(e.$slots),a=>({name:a,fn:v(C=>[me(e.$slots,a,Ee(Me(C||{})))])}))]),1040,["rowClassName","onChange"]),[[rn,e.getEmptyDataIsShowTable]])],2)}const Do=x(Co,[["render",bo]]);export{Do as B,Rn as H};
